<!DOCTYPE html>
<html>
	<head>
		<style>
		@import url(table.css);

		p, #list, pre {
			margin: 0.5em 0;
			padding: 0;
		}
		#list > li {
			display: inline;
		}
		#table {
			border-collapse: collapse;
			border: 1px #ddf solid;
		 	white-space: nowrap;
		}
		tr.filtered {
			display: none;
		}
		th {
			text-align: left;
		}
		#table td, #table th {
			border: 1px #ddf solid;
			padding: 2px 4px;
			max-width: 175px;
			overflow: hidden;
			text-overflow: ellipsis;
		}
		</style>
	</head>
	<body>
		<p>Display these columns:</p>
		<ul id="list">
			<li><label><input type="checkbox" data-columns="0" />Name of territory</label></li>
			<li><label><input type="checkbox" data-columns="1" />Area</label></li>
			<li><label><input type="checkbox" data-columns="2,3" />Population (2 columns)</label></li>
			<li><label><input type="checkbox" data-columns="4" />Capital</label></li>
			<li><label><input type="checkbox" data-columns="5" />Independence</label></li>
		</ul>
		<!-- <select id="select" multiple size="5">
			<option value="0" />Name of territory</option>
			<option value="1" />Area</option>
			<option value="2,3" />Population (2 columns)</option>
			<option value="4" />Capital</option>
			<option value="5" />Independence</option>
		</select> -->
		<p>Filter: <input id="filter" /><button onclick="clearFilter();">Clear</button></p>
		<table cellspacing="0" id="table"
			data-hiddencolumns="2,3" data-sortcolumn="0" data-sortdirection="asc">
			<thead>
				<tr class="sortrow">
					<th class="sortable">Name of territory</th>
					<th class="sortable">Area<br />(km²)</th>
					<th class="sortable">Population<br />(July 2009 est.)</th>
					<th class="sortable">Population density<br />(per km²)</th>
					<th class="sortable">Capital</th>
					<th class="sortable">Independence</th>
				</tr>
			</thead>
			<tbody>
				<tr>
					<td>Argentina</td>
					<td align="right">2,766,890</td>
					<td align="right">40,913,584</td>
					<td align="right">14.8</td>
					<td>Buenos Aires</td>
					<td data-sortable="1816-07-09">9 July 1816</td>
				</tr>
				<tr>
					<td>Bolivia</td>
					<td align="right">1,098,580</td>
					<td align="right">9,775,246</td>
					<td align="right">8.9</td>
					<td>La Paz, Sucre</td>
					<td data-sortable="1825-08-06">6 August 1825</td>
				</tr>
				<tr>
					<td>Brazil</td>
					<td align="right">8,511,965</td>
					<td align="right">198,739,269</td>
					<td align="right">23.3</td>
					<td>Brasília</td>
					<td data-sortable="1822-09-07">7 September 1822</td>
				</tr>
				<tr>
					<td>Chile</td>
					<td align="right">756,950</td>
					<td align="right">16,601,707</td>
					<td align="right">21.9</td>
					<td>Santiago</td>
					<td data-sortable="1818-02-12">12 February 1818</td>
				</tr>
				<tr>
					<td>Colombia</td>
					<td align="right">1,138,910</td>
					<td align="right">45,644,023</td>
					<td align="right">40.1</td>
					<td>Bogotá</td>
					<td data-sortable="1810-07-20">20 July 1810</td>
				</tr>
				<tr>
					<td>Ecuador</td>
					<td align="right">283,560</td>
					<td align="right">14,573,101</td>
					<td align="right">51.4</td>
					<td>Quito</td>
					<td data-sortable="1809-08-10">10 August 1809</td>
				</tr>
				<tr>
					<td>Falkland Islands (UK)</td>
					<td align="right">12,173</td>
					<td align="right">3,140</td>
					<td align="right">0.26</td>
					<td>Stanley</td>
					<td data-sortable=""></td>
				</tr>
				<tr>
					<td>French Guiana (France)</td>
					<td align="right">83,534</td>
					<td align="right">221,500</td>
					<td align="right">2.7</td>
					<td>Cayenne</td>
					<td data-sortable=""></td>
				</tr>
				<tr>
					<td>Guyana</td>
					<td align="right">214,970</td>
					<td align="right">772,298</td>
					<td align="right">3.6</td>
					<td>Georgetown</td>
					<td data-sortable="1966-05-26">26 May 1966</td>
				</tr>
				<tr>
					<td>Paraguay</td>
					<td align="right">406,750</td>
					<td align="right">6,995,655</td>
					<td align="right">17.2</td>
					<td>Asunción</td>
					<td data-sortable="1811-05-14">14 May 1811</td>
				</tr>
				<tr>
					<td>Peru</td>
					<td align="right">1,285,220</td>
					<td align="right">29,546,963</td>
					<td align="right">23.0</td>
					<td>Lima</td>
					<td data-sortable="1821-07-28">28 July 1821</td>
				</tr>
				<tr>
					<td>South Georgia and South Sandwich Islands (UK)</td>
					<td align="right">3,903</td>
					<td align="right">0</td>
					<td align="right">0</td>
					<td>Grytviken</td>
					<td data-sortable=""></td>
				</tr>
				<tr>
					<td>Suriname</td>
					<td align="right">163,270</td>
					<td align="right">481,267</td>
					<td align="right">2.9</td>
					<td>Paramaribo</td>
					<td data-sortable="1975-11-25">25 November 1975</td>
				</tr>
				<tr>
					<td>Uruguay</td>
					<td align="right">176,220</td>
					<td align="right">3,494,382</td>
					<td align="right">19.8</td>
					<td>Montevideo</td>
					<td data-sortable="1825-08-25">25 August 1825</td>
				</tr>
				<tr>
					<td>Venezuela</td>
					<td align="right">912,050</td>
					<td align="right">26,814,843</td>
					<td align="right">29.4</td>
					<td>Caracas</td>
					<td data-sortable="1830-01-13">13 January 1830</td>
				</tr>
			</tbody>
		</table>
		<p>(from <a href="http://en.wikipedia.org/wiki/Geography_of_South_America">Wikipedia</a>)</p>
		<p>What's stored in localStorage: <button onclick="clearStorage();">Clear &amp; reload</button></p>
		<pre id="output"></pre>
		<!--[if IE 8]><script src="shim/shim.js"></script><![endif]-->
		<script src="table.js"></script>
		<script>

		var storageKey = 'tableUtilsTest';

		var table = document.getElementById('table');
		var list = document.getElementById('list');
		// var select = document.getElementById('select');
		var filter = document.getElementById('filter');
		var output = document.getElementById('output');

		initTable(table);
		initList(list, table);
		// initSelect(select, table);
		initFilter(filter, table);

		table.tHead.addEventListener('click', updateOutput, false);
		list.addEventListener('change', updateOutput, false);

		updateOutput();

		function updateOutput() {
			var value = localStorage.getItem(table.id);
			output.textContent = value;
		}

		function clearFilter() {
			filter._value = filter.value = '';
			table.filter('');
		}

		function clearStorage() {
			var storageData = JSON.parse(localStorage.getItem(table.id));
			if (!storageData) {
				storageData = {};
			}
			delete storageData[storageKey];
			localStorage.setItem(table.id, JSON.stringify(storageData));
			// updateOutput();
			location.reload();
		}

		</script>
	</body>
</html>
